# Convex Hull

Tags: Algorithm

---

<!-- MDTOC maxdepth:6 firsth1:1 numbering:0 flatten:0 bullets:0 updateOnSave:1 -->

[Convex Hull](#convex-hull)
&emsp;[1. Graham scan 实现](#1-graham-scan-实现)
&emsp;&emsp;[1.1 要点](#11-要点)
&emsp;&emsp;[1.2 确定逆时针转角(CCW)](#12-确定逆时针转角ccw)

<!-- /MDTOC -->

---

输入一个点集，输出一个构成**能容纳所有点的最小多边形的顶点集合**

## 1. Graham scan 实现

1. 选择一个具有**最小 y 坐标的点 p**
2. 以 p 为原点，把其余点按照**极坐标**排序
3. 按顺序考虑其余点，如果出现**顺时针的拐角则将该点忽略**

### 1.1 要点

1. 如何寻找具有最小 y 坐标的点

    > 将点按照 y 坐标进行排序

2. 如何将点**按照极坐标**进行排序

    > 1. 计算出极坐标，然后进行排序
    > 2. 使用基于逆时针转角（CCW）的方法
        1. 如果 $q_1$ 在 $p$ 上方，$q_2$ 在 $p$ 下方，则 $q_1$ 极坐标较小
        2. 如果 $q_1$ 在 $p$ 下方，$q_2$ 在 $p$ 上方，则 $q_1$ 极坐标较大
        3. 否则，根据 $p \to q_1 \to q_2$ 的逆时针转角(`ccw(p, q1, q2)`) 确定极坐标大小
        >> 上述函数中，`ccw(p, q1, q2)` 返回 1，则 $q_2$ 较大，返回 -1 则 $q_1$ 较大

3. 如何确定各个点之间是逆时针转角

    > 几何问题，进行图形计算即可

4. 如何更有效的排序

    > 使用归并排序或者快速排序

5. 如何处理边界点（几个点在同一条直线上，**并不是顶点**）

    > 细心点

### 1.2 确定逆时针转角(CCW)

**使用三角形有向面积进行判定**

$$
2 \times Area(a, b, c) =
\begin{vmatrix}
a_x & a_y & 1\\
b_x & b_y & 1\\
c_x & c_y & 1\\
\end{vmatrix}
= \\
\begin{vmatrix}
b_x - a_x & b_y - a_y \\
c_x - a_x & c_y - a_y \\
\end{vmatrix}
$$

**如果面积为正，则为逆时针**
**如果面积为负，则为顺时针**
**如果面积为 0，则三点共线**

原理：根据空间向量的**右手系**可知，当法向量为负时，三点为顺时针；当法向量为正时，三点为逆时针。

而平面法向量和**两个向量的叉乘正负一致**，则可以通过求两个向量的叉乘判断顺逆时针的情况。

由向量叉乘的物理含义可知，**向量的叉乘就是两个向量所在的平行四边形的面积**

在三维条件下，叉乘为
$$
|a \times b| =
\begin{vmatrix}
i & j & k\\
a_x & a_y & a_z\\
b_x & b_y & b_z
\end{vmatrix}
$$

取 $z = 0$ 这一平面，则

$$
|a \times b| =
\begin{vmatrix}
a_x & a_y\\
b_x & b_y\\
\end{vmatrix}
$$

到这一步不难看出，上面两倍三角形有向面积的二维行列式表达正是二维空间中向量的叉乘。

所以，三角形有向面积的正负就表明了三角形三个点的顺时针和逆时针的特性。
